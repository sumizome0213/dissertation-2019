%Tex Live 2016
%pLaTeXでコンパイル
%目次や図・参考文献の参照（\figuref や \cite）を利用する場合は2回コンパイルしないと正しいPDFが生成されない（そういう仕様）
\documentclass[10pt,a4paper]{jsarticle}

%パッケージの使用宣言（includeやimportみないなもの）
\usepackage[top=35truemm,bottom=30truemm,left=30truemm,right=30truemm]{geometry}
\usepackage{fancyhdr}
\usepackage{setspace}
\usepackage{titlesec}
\usepackage[dvipdfmx]{graphicx}
\usepackage[format=hang]{caption}
\usepackage{listings, jlisting}
\usepackage{url}

%見出し表示調整
\titleformat{\section}[hang]{\huge \gtfamily}{\Huge \gtfamily \thesection}{1zh}{\Huge}[{\titlerule[2pt]}]
\titleformat{\subsection}[hang]{\Large \gtfamily}{\Large \gtfamily \thesubsection}{1zh}{\Large}[]

%キャプションの表示指定
\captionsetup[figure]{format=plain, labelformat=simple, labelsep=quad, font=large}
\captionsetup[table]{format=plain, labelformat=simple, labelsep=quad, font=large}
\captionsetup[lstlisting]{format=plain, labelformat=simple, labelsep=quad, font=large}

%tocloftパッケージを使用すると「第n章」とタイトルの「hogehoge」か被るので注意
\renewcommand{\presectionname}{第}
\renewcommand{\postsectionname}{章}

\makeatletter

%表紙作成マクロ
\def\id#1{\def\@id{#1}}
\def\department#1{\def\@department{#1}}
\def\thesis#1{\def\@thesis{#1}}
\def\university#1{\def\@university{#1}}
\def\supervisor#1{\def\@supervisor{#1}}

\def\@maketitle{
    \begin{center}
    \begin{spacing}{1.5}
    \vspace*{4zh}
    {\LARGE \@thesis \par}
    \vspace{38zh}
    {\LARGE \@date \par}
    \vspace{2zh}
    {\LARGE \@university \par}
    {\LARGE \@department \par}
    {\LARGE \@id \quad}
    {\LARGE \@author \par} 
    \vspace{2zh}
    {\LARGE 指導教員\quad \@supervisor \par}
    \vspace{-62zh}
    {\huge \gtfamily \@title \par}
    \end{spacing}
    \end{center}
}

%行数指定マクロ
\def\linesparpage#1{
    \baselineskip=\textheight
    \divide\baselineskip by #1
}

%refコマンドだけでは「図n hogehoge」と表示してくれないので
%\figuref{label}
\newcommand{\figuref}[1]{図\ref{#1}}
\newcommand{\tabref}[1]{表\ref{#1}}

\renewcommand{\figurename}{図}
\renewcommand{\tablename}{表}

%図表示用マクロ
%\fig{source path}{caption}{label}
\newcommand{\fig}[4][width=\textwidth]{
    \begin{figure}[!h]
    \begin{center}
    \includegraphics[#1]{#2}
    \caption{#3}
    \label{#4}
    \vspace*{-1cm}
    \end{center}
    \end{figure}
}

\setlength\textfloatsep{0pt}

%リスト表示用設定
\renewcommand{\lstlistingname}{リスト}
\newcommand{\lstref}[1]{リスト\ref{#1}}
\lstset{
    %language=, （言語を指定しない場合（対応していない言語を含む））
    language=C, %例：C言語を指定
    basicstyle=\normalsize,
    commentstyle=\textit,
    classoffset=1,
    keywordstyle=\bfseries,
    frame=tRBl,
    framesep=5pt,
    showstringspaces=false,
    numbers=left,
    stepnumber=1,
    numberstyle=\large
}

\makeatother

\title{モーションシミュレータを用いた重機の遠隔操縦に関する研究} %タイトル
\thesis{2019年度　卒業論文} %年度
\date{2020年2月} %日付
\id{15077} %学籍番号
\author{坂上 祥太郎} %氏名
\university{国立東京工業高等専門学校} %学校名
\department{情報工学科　制御情報研究室} %研究室名
\supervisor{松林勝志，山下晃弘} %教員名

\begin{document}
\linesparpage{36} %行数指定

%表紙
\begin{titlepage}
\maketitle
\thispagestyle{empty}
\end{titlepage}

%目次
\tableofcontents
\thispagestyle{empty}
\clearpage

%以下本文
\setcounter{page}{1}
\pagestyle{plain}

\section{はじめに}

\subsection{研究背景}
クローラキャリアやバックホウなどの重機の遠隔操縦は，作業の少人数化や人が立ち入ることが難しい場所での作業などに大きく貢献する事ができる。実際にAIと遠隔操縦を活用することにより，操縦室からオペレータ一人で複数台の重機の操縦 \cite{kumagai_AI}や，災害時の緊急対応の実験\cite{kumagai_mujin}も行われている。

遠隔操縦は，現場の状況を重機や現場に設置されたカメラの映像を見ながらコントローラを用い操縦することがほとんどである。しかしこの場合，実際の操縦と異なり重機の傾きや振動をオペレータが体感する事ができない。そのため，急な斜面での操縦の際に重機の横転やオペレータから見えない埋設管の破壊などの事故が起こることがあった。また，遠隔操縦では重機に設置したカメラと重機を俯瞰する映像のみを頼りに作業を行うため，通常の約半分にまで作業効率が低下してしまう。\cite{nec}

\subsection{研究目的}
本研究では，ヘッドマウントディスプレイ(以下HMD)と小型モーションシミュレータを使用したスポーツ体感システム「シンクロアスリート」を応用し，高精細4K全天球カメラを使用した実際の運転と同等の映像と，車体の傾きや振動をオペレータが体感することで，実際の操縦と同等の状態で操縦できるシステムを開発し，安全安心かつ極めて作業効率の高い重機の運用を実現する。

\subsection{本論文の構成}
「第１章　はじめに」では，本論文の研究背景，研究目的を示す。「第２章　システム概要」では，本システムの概要と構成，システム構成要素を述べる。「第３章　ヒアリング調査」では，オペレータの方に行ったヒアリングの結果を述べる。「第４章　筐体の設計」では，筐体の変更点を示す。「第５章　プログラムの変更」では，プログラムの変更点を示す。「第6章　実証実験」では，制作した本体を用いて実験・評価をする。「第６章　まとめ」では，今後の展望について述べる。

\clearpage

\section{システム概要}
\subsection{システム構成}
本システムは，リアルタイムに選手とシンクロするスポーツ観戦システム「シンクロアスリート」\cite{synchro}を元に，筐体・ソフトウェアを変更し，実現する。システム構成図を\figuref{sys_config}に示す。
\fig{image/sys_config.png}{システム構成図}{sys_config}

\clearpage

\section{ヒアリング調査}
\subsection{概要}
新筐体を設計するにあたって，現行のシンクアロアスリートの問題を洗い出す必要がある。そこで，共同研究先である熊谷組のオペレータの方にヒアリングを行った。\figuref{synchro_image}のシンクロアスリートに収録したクローラーダンプの映像と動きのコンテンツを入れ，体験して頂いた。
\fig[width=9cm]{image/synchro_image.jpg}{シンクロアスリート}{synchro_image}

\subsection{映像の収録}
この映像と動きは熊谷組筑波技術研究所内の実験フィールド(\figuref{test_field})で収録した。収録では，前進・後退に加え斜面の登り降りや左右に傾いた斜面の走行など，工事現場で想定される一連の動きを再現した。また，全天球カメラは操縦室車内に取り付け，実際の操縦と同じ目線で体感できるようにした。
\fig[width=9cm]{image/test_field.jpg}{実験フィールド}{test_field}

\subsection{ヒアリング結果}
ヒアリングの結果，「本物の重機とほぼ同じような感覚を得ることができる」と評価をしていただいた。しかし，いくつかの課題の指摘もあった。

\subsubsection{座席の問題}
丸型の座面は体が安定せず操縦がしづらいことがわかった。現状のシンクロアスリートは防音性・遮音性を高め，臨場感を向上させるため，球状の椅子を使用している。しかし操縦の際は実際に重機に使われているような形状のシートである方が望ましい。

\subsubsection{操縦性の問題}
HMDでは操縦が行い辛いということがわかった。遠隔操縦の際には手元のジョイスティックやボタンなどのコントローラで操縦する。HMDをかぶると，手元のコントローラを見ることができない。また，HMDは360度すべての方向を見ることができるという利点もあるが，その反面酔いやすいという欠点もある。遠隔操縦では，長時間オペレータが作業するためなるべく酔いにくくする必要がある。

\clearpage

\section{筐体の開発}
\subsection{概要}
第3章で述べた問題を踏まえ筐体の設計・製作を行った。筐体は拡張性や汎用性を考え，主に20mmx20mmのアルミフレームを使用した。また，設計はコンピューター上で行った。開発環境を以下に示す。
\begin{itemize}
    \item OS : Microsoft Windows 10 Pro
    \item プロセッサ : Intel Core i7-6700k
    \item メモリ : DDR4 32GB
    \item GPU : NVDIA Quadro K4000
    \item CADソフトウェア : SolidWorks 2017-2018
\end{itemize}

\subsection{設計}
設計ではシンクロアスリートの筐体の設計図を改変する形をとった。具体的に主に以下の点を変更した。

\subsubsection{椅子の変更}
体をホールドしない以前の丸型の椅子から,体をしっかりホールドする自動車運転用の椅子(\figuref{recaro})に変更する。
\fig[width=9cm]{image/test_field.jpg}{自動車運転用の椅子}{recaro}

\subsubsection{筐体へのディスプレイの取り付け}
HMDは360°見ることができるが，コントローラを目視することができない。そのためディスプレイ三台を筐体に取り付け，椅子と同時に動かし，ディスプレイを使っての操縦も可能にした。

\subsubsection{コントローラの設置}
操縦の際にはコントローラが必要である。実際の重機と同等のコントローラー(\figuref{controller})を左手アームレストに設置した。それにより乗り降りの障害にならず，且つ操縦が行いやすくした。
\fig[width=9cm]{image/test_field.jpg}{重機のコントローラー}{controller}

\subsection{製作}
上記を踏まえ，設計した図面を元に製作した。\figuref{body}が製作した筐体である。
\fig[width=9cm]{image/test_field.jpg}{製作した筐体}{body}

\clearpage

\section{ソフトウェアの変更}

\section{いろいろ}
\subsection{いろいろ}
hoge
\lstinputlisting[caption=Hello Wordのソースコード,label=helloworld]{src/hello_world.c}
\lstref{helloworld}はCのソースコードです．

\fig{image/atom.jpg}{原子}{atom}

\figuref{atom}は原子です\cite{irasutoya}．

\clearpage

\section{まとめ}
hoge

\clearpage

\section*{謝辞} %章番号を振らないセクションの作成
\addcontentsline{toc}{section}{謝辞} %章番号がないセクションを目次に表示させる
hoge

\clearpage

\begin{flushleft} %左寄せ
\begin{thebibliography}{9} %参考文献一覧　参考文献の個数が1桁なら9，2桁なら99...といった感じで
\addcontentsline{toc}{section}{参考文献}

\bibitem{kumagai_AI}
株式会社 熊谷組, AI制御による不整地運搬車（クローラキャリア）の自動走行技術の開発(オンライン), 入手先〈\url{https://www.kumagaigumi.co.jp/news/2019/pr_20190404_1.html}〉(参照 2019-7-4).


\bibitem{kumagai_mujin}
株式会社 熊谷組, 無人化施工における高機能遠隔操作室の開発　災害時の緊急対応を可能にする移動式遠隔操作室, 入手先〈\url{https://www.kumagaigumi.co.jp/news/2016/pr_160324_1.html}〉(参照 2019-7-4).


\bibitem{nec}
日本電気株式会社, KDDI，大林組，NEC国内初！「5G」，4K3Dモニターを活用した建機の遠隔施工に成功, 入手先〈\url{https://jpn.nec.com/press/201802/20180215_01.html}〉(参照 2019-7-4).

\bibitem{synchro}
松林勝志 山下晃弘 冨平準喜 佐藤悠之輔 瀧島和則 本間朗 吉川千里, 3自由度モーションベースの制御とカヌー競技への応用, 情報処理学会論文誌コンシューマ・デバイス＆システム, Vol.9, No.3, pp.1-9 (2019)

\bibitem{irasutoya}
いらすとや，原子のイラスト，
\\ %改行
http://www.irasutoya.com/2017/02/blog-post\_20.html %_（アンダースコア）など一部の文字は\などでエスケースさせる必要あり

\end{thebibliography}
\end{flushleft}

\end{document}